 
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
    </head>
    <body>
    <p class="site-subtitle">给时光以生命。</p> <p>我们知道，如果我们在 Python 中想把一段数据持久化到硬盘上，最简单的办法就是写文件：</p> <p>但这样做有一个弊端，就是在读取数据的时候，我们把整个数据读入内存以后，还需要单独写一段代码，用来区分哪里是<code>username</code>对应的值，哪些是<code>password</code>对应的值。</p> <p>实际上，在 Python 中，我们可以使用<code>shelve</code>模块，像读写字典一样持久化存储数据。例如，在 <code>write.py</code>文件中，我们写如下代码：</p> <p>运行完成以后，会在<code>write.py</code>所在的文件夹下面生成一个<code>data.db</code>文件，如下图所示：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/2019-11-16-22-07-33.png"/></p> <p>现在，我们再写一个<code>read.py</code>，其内容如下：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/2019-11-16-22-09-20.png"/></p> <p>不需要我们单独做额外的解析，就能像读取字典一样读取持久化到硬盘中的数据。</p> <p>并且，原来写文本文件的时候，如果我们的数据是字典或者列表，直接写入还会报错，必需先转成 JSON 字符串才能写入。</p> <p>但<code>shelve</code>模块没有这个限制，所有能被 <code>pickle</code>的对象，都可以存入，例如：</p> <p>需要注意的是，<code>shelve</code>模块底层基于<code>pickle</code>模块，所以当别人传给你一个 <code>shelve</code>生成的文件时，不能贸然打开，否则可能会执行危险的代码。</p> <p>另外，<code>shelve</code>模块只支持多线程同时读取。不支持多线程写入，也不支持同时读写。</p> <p>关于<code>shelve</code>的更多参数，可以参阅它的<a href="https://docs.python.org/3.8/library/shelve.html" rel="noopener" target="_blank">官方文档</a>.</p> <p class="site-author-name" itemprop="name">谢乾坤 | Kingname</p> <p class="site-description motion-element" itemprop="description">高级数据挖掘工程师，《Python 爬虫开发 从入门到实战》、《左手 MongoDB 右手 Redis——从入门到商业实战》作者。 微软最有价值专家 MVP，Python Scrapy MongoDB Redis Pandas Golang。</p>
    </body>
    </html>
    