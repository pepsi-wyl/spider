 
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
    </head>
    <body>
    <p class="site-subtitle">给时光以生命。</p> <p>我们平时导入第三方模块的时候，一般使用的是<code>import</code>关键字，例如：</p> <p>但是如果各位同学看过 Scrapy 的<code>settings.py</code>文件，就会发现里面会通过字符串的方式来指定pipeline 和 middleware，例如：</p> <p>我们知道，这里的<code>Test.middlewares.ExceptionRetryMiddleware</code>实际上对应了根目录下面的<code>Test</code>文件夹里面的<code>middlewares.py</code>文件中的<code>ExceptionRetryMiddleware</code>类。那么 Scrapy 是如何根据这个字符串，导入这个类的呢？</p> <p>在 Scrapy 源代码中，我们可以找到<a href="https://github.com/scrapy/scrapy/blob/master/scrapy/utils/misc.py#L33" rel="noopener" target="_blank">相关的代码</a>：</p> <p>根据这段代码，我们知道，它使用了<code>importlib</code>模块的<code>import_module</code>函数：</p> <p>现在我们来测试一下。我们创建的测试文件结构如下图所示：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/2019-10-22-22-27-25.png"/></p> <p>其中，<code>pipelines.py</code>文件的内容如下图所示：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/2019-10-22-22-27-57.png"/></p> <p><code>main.py</code>文件的内容如下图所示：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/2019-10-22-22-31-23.png"/></p> <p>运行<code>main.py</code>，可以看到<code>pipelines.py</code>中的<code>Pipeline</code>类被成功执行了，如下图所示：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/2019-10-22-22-33-39.png"/></p> <p class="site-author-name" itemprop="name">谢乾坤 | Kingname</p> <p class="site-description motion-element" itemprop="description">高级数据挖掘工程师，《Python 爬虫开发 从入门到实战》、《左手 MongoDB 右手 Redis——从入门到商业实战》作者。 微软最有价值专家 MVP，Python Scrapy MongoDB Redis Pandas Golang。</p>
    </body>
    </html>
    