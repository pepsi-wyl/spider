 
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
    </head>
    <body>
    <p class="site-subtitle">给时光以生命。</p> <p>在macOS中直接复制文件路径，在Finder中选中文件，按下快捷键：<code>Command</code> + <code>Option</code> + <code>C</code></p> <p>以KB，MB，GB方式显示文件大小<br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">ls -lh</span><br/></pre></td></tr></table></figure></p> <p>删除超大文本文件的特定行数</p> <p>切分超大文本文件</p> <p>修改Linux当前用户密码</p> <p>使用Python打开一个未知编码的文件：<br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"your_file"</span> <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br/><span class="line">    file_data = fp.read()</span><br/><span class="line">    result = chardet.detect(file_data)</span><br/><span class="line">    file_content = file_data.decode(encoding=result[<span class="string">'encoding'</span>])</span><br/></pre></td></tr></table></figure></p> <p>在SSH + Tmux中，如果想复制，按住<code>Alt</code>或者<code>Option</code>键再选择就可以复制了。</p> <p>关闭requests的SSL警告<br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br/><span class="line">requests.packages.urllib3.disable_warnings()</span><br/></pre></td></tr></table></figure></p> <p>在VIM中，<code>Crtl</code> + <code>V</code> <code>Ctrl</code> + <code>A</code>可以输出特殊符合<code>^A</code>，把A改为可以得到<code>^M</code></p> <p>在Python中，pymongo的find方法返回的是一个生成器，只有在迭代的时候才会执行里面的具体代码去读MongoDB。但是在Golang的Mgo包中，如果想让Find返回一个迭代器而不是直接把所有结果全部返回，就需要手动指定：<br/><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> xInfo <span class="keyword">struct</span> {</span><br/><span class="line">	ID <span class="keyword">int</span> <span class="string">`bson:"mt_poi_id"`</span></span><br/><span class="line">	Count <span class="keyword">int</span> <span class="string">`bson:"count"`</span></span><br/><span class="line">}</span><br/><span class="line">resultIter = m.handler.Find(<span class="literal">nil</span>).Select(bson.M{<span class="string">"_id"</span>: <span class="number">0</span> <span class="string">"mt_poi_id"</span>: <span class="number">1</span> <span class="string">"count"</span>: <span class="number">1</span>}).Iter()</span><br/><span class="line"><span class="keyword">var</span> x xInfo</span><br/><span class="line"><span class="keyword">for</span> resultIter.Next(&amp;xInfo) {</span><br/><span class="line">    fmt.Println(xInfo.Id)</span><br/><span class="line">    fmt.Println(xInfo.Count)</span><br/><span class="line">}</span><br/></pre></td></tr></table></figure></p> <p>在Golang中，使用MySQL的事务：<br/><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line"><span class="comment">// paraArray为一个channel，里面是更新所需要的参数</span></span><br/><span class="line">tx _ := db.Begin()</span><br/><span class="line">    <span class="keyword">for</span> _ para := <span class="keyword">range</span> paraArray{</span><br/><span class="line">        tx.Exec(<span class="string">"update....."</span> para) </span><br/><span class="line">    }</span><br/><span class="line">    tx.Commit()</span><br/></pre></td></tr></table></figure></p> <p>由于更新MySQL会锁表，因此使用多个goroutine来更新MySQL，效果可能还不如直接在主线程中更新来的高。</p> <p>在Golang中，使用goroutine太多反而会导致性能下降。</p> <p>在Python中，可以使用<code>&gt;</code>或者<code>&gt;=</code>来判断一个集合是不是另一个集合的子集。只有是子集才会返回<code>True</code><br/><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/2017-05-04-09-58-18.png"/></p> <p>在MongoDB中，通过_id来更新数据：<br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bson.objectid <span class="keyword">import</span> ObjectId</span><br/><span class="line"><span class="keyword">import</span> pymongo</span><br/><span class="line">conn = pymongo.MongoClient().XX.YY</span><br/><span class="line">conn.update({<span class="string">'_id'</span>: ObjectId(<span class="string">'adf84a8fafasf3213'</span>) {<span class="string">'$set'</span>: {<span class="string">'name'</span>: <span class="string">'aaa'</span>}}})</span><br/></pre></td></tr></table></figure></p> <p>在Python 3中，计算两个日期相隔了多少秒：<br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line">start = <span class="string">'2017-03-21 17:21:30'</span></span><br/><span class="line">end = <span class="string">'2017-03-21 18:10:13'</span></span><br/><span class="line"></span><br/><span class="line">start_datetime = datetime.datetime.strptime(start <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br/><span class="line">end_datetime = datetime.datetime.strptime(end <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br/><span class="line"></span><br/><span class="line">total_seconds = (end_datetime - start_datetime).total_seconds()</span><br/></pre></td></tr></table></figure></p> <p>Scrapy中，通过覆写items.py中，每个item的__repr__方法，可以减少打印出来的Log信息。<br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XXXItem</span><span class="params">(Item)</span>:</span></span><br/><span class="line">    name = Field()</span><br/><span class="line">    age = Field()</span><br/><span class="line"></span><br/><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br/><span class="line">        <span class="keyword">return</span> <span class="string">'======data has been stored.======='</span></span><br/></pre></td></tr></table></figure></p> <p>在VIM粘贴Python代码的时候，缩进会一不小心爆炸。为了避免这个问题，应该先在normal模式输入<br/><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">:set paste</span><br/></pre></td></tr></table></figure></p> <p>回车，再按i，再粘贴。这样Python的缩进就不会乱掉了。</p> <p>Selenium的Debug级的Log有时候打得太多了，为了去掉Selenium的Debug Log又不影响其他部份的Debug Log，可以使用如下命令完成：<br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br/><span class="line"><span class="keyword">from</span> selenium.webdriver.remote.remote_connection <span class="keyword">import</span> LOGGER</span><br/><span class="line">LOGGER.setLevel(logging.WARNING)</span><br/></pre></td></tr></table></figure></p> <p class="site-author-name" itemprop="name">谢乾坤 | Kingname</p> <p class="site-description motion-element" itemprop="description">高级数据挖掘工程师，《Python 爬虫开发 从入门到实战》、《左手 MongoDB 右手 Redis——从入门到商业实战》作者。 微软最有价值专家 MVP，Python Scrapy MongoDB Redis Pandas Golang。</p>
    </body>
    </html>
    