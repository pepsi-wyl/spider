 
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
    </head>
    <body>
    <p class="site-subtitle">给时光以生命。</p> <p>在多年写代码的过程中，我总结了不少常用的工具函数。这些工具函数有的能够实现快速重试网络请求，有的可以把任意格式的时间转成标准格式，还有的可以自动生成正则表达式。</p> <p>我把这些工具函数分别放到多个<code>.py</code>文件中。然后把这些<code>.py</code>文件放在一个叫做<code>my_awesome_util</code>的文件夹中。</p> <p>由于我没有把这些代码上传到Pypi或者Github，因此我每次在新的项目中要使用时，都要把<code>my_awesome_util</code>文件夹复制到新的项目中，非常麻烦，而且会形成大量的重复代码。</p> <p>有没有什么办法，能让新开的项目直接就能导入这些工具函数呢？就像导入官方模块<code>import time</code>一样，如果我要使用时间相关的工具函数，我只需要<code>import time_util</code>就可以了。</p> <p>首先要排除的方法，就是手动在代码里面，通过<code>sys.path</code>添加文件夹。因为这个方法需要在每个项目的入口文件中增加两行代码，无法做到<code>全自动</code>。</p> <p>今天的方法，是在Python的<code>site-packages</code>文件夹中做文章。相信很多同学都知道，任何放到<code>site-packages</code>文件夹里面的<code>.py</code>文件或者文件夹，都可以在Python中直接导入：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/20220411175822.png"/></p> <p>看到这里，肯定有同学要问，那是不是把<code>my_awesome_util</code>文件夹整个复制到<code>site-packages</code>文件夹中呢？</p> <p>当然不是的。因为我的工具包里面的代码是在持续演进的，我会经常更新里面的代码，放到<code>site-packages</code>里面以后，代码修改起来很不方便。</p> <p>我们要用到的，是Python的一个特性，叫做<code>.pth</code>文件。在<code>site-packages</code>文件夹中，任意创建一个<code>.pth</code>文件。文件名可以随便取，只要不跟已有的模块冲突就可以了。例如叫做<code>xxxx.pth</code>。这个文件里面只有一行，就是<code>my_awesome_util</code>文件夹的绝对路径。例如：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/20220411180625.png"/></p> <p>现在，我在任何一个文件夹中启动Python，直接就可以导入<code>my_awesome_util</code>文件夹中的任何<code>.py</code>文件：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/20220411180531.png"/></p> <p><code>.pth</code>文件可以有很多行，每行一个文件夹的绝对路径，就可以让Python同时导入这些文件夹里面的所有<code>.py</code>文件。</p> <p>有时候，我们的电脑上有多个虚拟环境。A环境有pandas，没有pymongo；B环境有pymongo，但没有pandas。现在我在B环境里面要写一段代码，既需要pandas，又需要pymongo怎么办呢？如果不想重新安装，我可以把A环境的<code>site-packages</code>文件夹的绝对路径，写入到一个<code>.pth</code>文件中，然后把这个文件存放到B环境的<code>site-packages</code>文件夹中。这样，我就可以在B环境里面直接使用A环境中的所有第三方库了。</p> <p>有同学会问，怎么知道<code>site-packages</code>文件夹在哪里呢？其实只需要执行下面两行代码就能查询到：</p> <p>运行效果如下图所示：</p> <p><img alt="" src="https://kingname-1257411235.cos.ap-chengdu.myqcloud.com/20220411181203.png"/></p> <p class="site-author-name" itemprop="name">谢乾坤 | Kingname</p> <p class="site-description motion-element" itemprop="description">高级数据挖掘工程师，《Python 爬虫开发 从入门到实战》、《左手 MongoDB 右手 Redis——从入门到商业实战》作者。 微软最有价值专家 MVP，Python Scrapy MongoDB Redis Pandas Golang。</p>
    </body>
    </html>
    